<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stock Investment Dashboard</title>

  <!-- Bootstrap -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"/>
  <!-- Bootstrap Icons -->
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"/>
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
  <!-- Custom styles -->
  <link rel="stylesheet" href="styles.css" />
  <!-- Plotly.js -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>
  <!-- ── Banner / Navbar ───────────────────────────────────────── -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white big-navbar">
    <div class="container-fluid">
      <a class="navbar-brand d-flex align-items-center gap-2" href="#">
        <img class="logo"
             src="https://www.wadetrim.com/wp-content/uploads/wade-trim-logo_696x696.png"
             alt="Wade Trim"/>
        <span class="fs-3 fw-bold">Stock Dashboard</span>
      </a>
    </div>
  </nav>

  <!-- ── Tab Bar ──────────────────────────────────────────────── -->
  <div class="container-fluid mt-4">
    <ul class="nav nav-tabs rounded-tabs flex-nowrap overflow-auto" id="dashboardTabs" role="tablist">
      <li class="nav-item">
        <button class="nav-link" id="historical-tab"
                data-bs-toggle="tab" data-bs-target="#historical"
                type="button" role="tab">
          Historical Performance
        </button>
      </li>
      <li class="nav-item">
        <button class="nav-link" id="detailed-tab"
                data-bs-toggle="tab" data-bs-target="#detailed"
                type="button" role="tab">
          Detailed Tabulation
        </button>
      </li>
      <li class="nav-item">
        <button class="nav-link" id="projected-tab"
                data-bs-toggle="tab" data-bs-target="#projected"
                type="button" role="tab">
          Projected Growth
        </button>
      </li>
    </ul>

    <div class="tab-content" id="dashboardTabsContent">
      <!-- ════════════════════════════════════════════════════
           HISTORICAL PERFORMANCE TAB
      ════════════════════════════════════════════════════ -->
      <div class="tab-pane fade" id="historical" role="tabpanel" aria-labelledby="historical-tab">
        <div class="row mt-4">
          <!-- Investment Input Panel -->
          <div class="col-lg-4 mb-4">
            <div class="card h-100">
              <div class="card-body d-flex flex-column">
                <h2 class="card-title">Investments by Financial Year</h2>
                <p class="text-muted">
                  Purchases assumed to be in April of the following year at the new stock price
                </p>

                <!-- Preset Buttons -->
                <div id="presetPanel" class="mb-3">
                  <h6>Preset Investments ($100,000 investment)</h6>
                  <!-- JS injects preset & clear buttons -->
                </div>

                <!-- Slider Table -->
                <div id="sliderScrollContainer" class="flex-grow-1">
                  <table class="table table-striped mb-0">
                    <thead>
                      <tr>
                        <th>Financial Year</th>
                        <th>Stock Price</th>
                        <th>Purchase</th>
                        <th>Amount</th>
                        <th>Apply to Following Years</th>
                      </tr>
                    </thead>
                    <tbody id="sliderTable"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <!-- Chart & Summary Panel -->
          <div class="col-lg-8 mb-4">
            <div class="card h-100">
              <div class="card-body d-flex flex-column">
                <h2 class="card-title">Stock Value Over Time</h2>
                  <div id="chart" style="width:100%;height:450px;"></div>
                  <button id="downloadMainChart" class="btn btn-secondary mt-2 limited-btn">
                    <i class="bi bi-download"></i> Download Chart
                  </button>

                  <div id="summaryScrollContainer"
                       class="table-responsive mt-3 flex-grow-1">
                    <table id="summaryTable" class="table table-bordered mb-0">
                    <thead>
                      <tr>
                        <th>Financial Year</th><th>Price</th>
                        <th>Cumulative Invested</th>
                        <th>Total Value</th><th>S&amp;P 500</th>
                      </tr>
                    </thead>
                    <tbody id="summaryBody"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div><!-- /row -->
      </div><!-- /historical tab -->

      <!-- ════════════════════════════════════════════════════
           DETAILED TABULATION TAB
      ════════════════════════════════════════════════════ -->
      <div class="tab-pane fade" id="detailed" role="tabpanel" aria-labelledby="detailed-tab">
        <div class="row mt-4">
          <div class="col-12 mb-4">
            <div class="card">
              <div class="card-body">
                <h2 class="card-title">Detailed Tabulation</h2>
                <div class="table-responsive">
                  <table id="detailedTable" class="table table-bordered">
                    <thead>
                      <tr>
                        <th>Financial Year</th><th>Stock Price</th>
                        <th>Invested This Year</th>
                        <th>Cumulative Invested</th>
                        <th>Employee Shares (Year)</th>
                        <th>Cumulative Employee Shares</th>
                        <th>Match Awarded This Year (#)</th>
                        <th>Cumulative Match Awarded (#)</th>
                        <th>Cumulative Match Awarded</th>
                        <th>Employee Value</th>
                        <th>Match Value</th>
                        <th>Total Value</th>
                        <th>S&amp;P 500</th>
                        <th>S&amp;P Price</th>
                        <th>ROI (%)</th>
                      </tr>
                    </thead>
                    <tbody id="detailedBody"></tbody>
                  </table>
                </div>

                <button id="exportCSV" class="btn limited-btn mt-3" type="button">
                  <i class="bi bi-download"></i> Export to CSV
                </button>

                <div class="mt-3 text-muted small">
                  <strong>Notes:</strong>
                  <ul>
                    <li>S&amp;P 500 value assumes equal investment on April 1 each year in an index fund.</li>
                    <li>ROI = (Total Value − Cumulative Invested) ÷ Cumulative Invested.</li>
                    <li>Click “Snap Investments” to round to whole shares.</li>
                    <li>Stock price for a given year is announced the following April (e.g., 2024 price set in April 2025).</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div><!-- /detailed tab -->

      <!-- ════════════════════════════════════════════════════
           PROJECTED GROWTH TAB
      ════════════════════════════════════════════════════ -->
      <div class="tab-pane fade" id="projected" role="tabpanel" aria-labelledby="projected-tab">
        <div class="row g-3 align-items-start flex-lg-nowrap mt-4">
          <!-- Scenario Settings (shrink‑wrap column) -->
          <div class="col-12 col-lg-auto">
            <div class="card scenario-card">
              <div class="card-body">
                <h2 class="card-title">Scenario Settings</h2>

                <label class="form-label mt-2" for="projectionYears">Projection (years)</label>
                <input id="projectionYears" type="number"
                       class="form-control form-control-sm" value="7"/>
                <input id="projectionYearsSlider" type="range" class="slider"
                       min="0" max="50" value="7"/>

                <label class="form-label mt-3" for="annualPurchase">Annual Additional Purchase ($)</label>
                <input id="annualPurchase" type="text"
                       class="form-control form-control-sm currency-input" value="$0"/>
                <input id="annualPurchaseSlider" type="range" class="slider"
                       min="0" max="10000" value="0"/>

                <label class="form-label mt-3" for="conservativeRate">Conservative Growth (%)</label>
                <input id="conservativeRate" type="number"
                       class="form-control form-control-sm" value="6"/>
                <input id="conservativeRateSlider" type="range" class="slider"
                       min="0" max="30" value="6"/>

                <label class="form-label mt-3" for="baseRate">Base Growth (%)</label>
                <input id="baseRate" type="number"
                       class="form-control form-control-sm" value="10"/>
                <input id="baseRateSlider" type="range" class="slider"
                       min="0" max="30" value="10"/>

                <label class="form-label mt-3" for="aggressiveRate">Aggressive Growth (%)</label>
                <input id="aggressiveRate" type="number"
                       class="form-control form-control-sm" value="14"/>
                <input id="aggressiveRateSlider" type="range" class="slider"
                       min="0" max="30" value="14"/>

                <p class="text-muted small mt-4 mb-0">
                  Past performance is not a guarantee of future results.<br/>
                  Excludes tax implications on matching shares and capital gains.
                </p>
              </div>
            </div>
          </div>

          <!-- Projected Growth chart & table -->
          <div class="col-12 col-lg projected-chart-col">
            <div class="card h-100">
              <div class="card-body d-flex flex-column">
                <h2 class="card-title">Projected Growth</h2>
                <div id="scenarioChart"
                     style="width:100%;height:450px;"></div>
                <button id="downloadProjectionChart" class="btn btn-secondary mt-2 limited-btn">
                  <i class="bi bi-download"></i> Download Chart
                </button>

                <div class="mt-3 flex-grow-1">
                  <table id="projectionTable" class="table table-bordered mb-0">
                    <thead>
                      <tr>
                        <th>Financial Year</th>
                        <th>Conservative</th>
                        <th>Base</th>
                        <th>Aggressive</th>
                      </tr>
                    </thead>
                    <tbody id="projectionBody"></tbody>
                  </table>
                </div>
                <button id="exportProjectionCSV" class="btn limited-btn mt-3" type="button">
                  <i class="bi bi-download"></i> Export Projection CSV
                </button>
              </div>
            </div>
          </div>
        </div><!-- /row -->
      </div><!-- /projected tab -->
    </div><!-- /tab-content -->

    <!-- Navigation Buttons -->
    <div class="d-flex justify-content-end gap-2 mt-3">
      <button id="goToDetailsBtn" class="btn btn-secondary">
        <i class="bi bi-arrow-right-circle"></i> Go to Details
      </button>
      <button id="goToProjectionBtn" class="btn btn-secondary">
        <i class="bi bi-arrow-right-circle"></i> Go to Projected Growth
      </button>
    </div>
  </div><!-- /container -->

  <footer class="text-muted small text-center mt-4">
    This dashboard is for informational purposes only and does not constitute financial advice. Data is provided as-is without warranty.
  </footer>

  <!-- Scripts -->
    <script type="module" src="js/main.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

